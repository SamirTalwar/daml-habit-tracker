module Tests where

import DA.Date
import DA.Time

import Main

recordHabits = scenario do
  alice <- getParty "Alice"

  run <- submit alice do
    create Habit with
      owner = alice
      name = "Run"

  pass <$> subTime (time (date 2020 Jul 1) 12 0 0) =<< getTime
  submit alice do
    exercise run Habit_Record with
      dateCompleted = date 2020 Jul 1
  pass <$> subTime (time (date 2020 Jul 2) 9 0 0) =<< getTime
  submit alice do
    exercise run Habit_Record with
      dateCompleted = date 2020 Jul 2
  pass <$> subTime (time (date 2020 Jul 3) 18 0 0) =<< getTime
  submit alice do
    exercise run Habit_Record with
      dateCompleted = date 2020 Jul 3

recordHabitsRecently = scenario do
  bob <- getParty "Bob"

  cook <- submit bob do
    create Habit with
      owner = bob
      name = "Cook"

  pass <$> subTime (time (date 2020 Jul 3) 9 0 0) =<< getTime
  submit bob do
    exercise cook Habit_Record with
      dateCompleted = date 2020 Jul 3
  submit bob do
    exercise cook Habit_Record with
      dateCompleted = date 2020 Jul 2
  submitMustFail bob do
    exercise cook Habit_Record with
      dateCompleted = date 2020 Jul 1
  submitMustFail bob do
    exercise cook Habit_Record with
      dateCompleted = date 2020 Jul 4
